package {	// Import all dependencies	import flash.display.MovieClip;	import flash.events.MouseEvent;		// Declare our Voter class.	public class Voter extends MovieClip	{		// The Voter constructor.				public function Voter()		{			super();						// Initialize our fill widths.			voting.fill.width = 0;			uservote.fill.width = 0;			vote.fill.width = 0;						setUserMode( false );					}				// Sets the user mode for this voter.		public function setUserMode( _user:Boolean )		{			// Store the state.			userMode = _user;						// Hide or show depending on the mode.			votes.visible = userMode;			vote.visible = !userMode;			uservote.visible = userMode;			voting.visible = userMode;						if( userMode ) {								// Iterate through all the hit regions.				for each( var v:MovieClip in votes ) {									// Setup each hit region for voting.					v.buttonMode = true;					v.mouseChildren = false;					v.addEventListener( MouseEvent.CLICK, onVote );					v.addEventListener( MouseEvent.MOUSE_OVER, onVoteOver );				}										// Called when the mouse exits the voter.				this.addEventListener( MouseEvent.MOUSE_OUT, onOut );							}					}						// Gets a vote for any node.		public function getVote( _drupal:DrupalService, _nodeId:Number )		{			// Store the node Id and drupal connection.			nodeId = _nodeId;			drupal = _drupal;						// Get the vote from Drupal.			var cmd:String = userMode ? "vote.getUserVote" : "vote.getVote";			drupal.serviceCall( cmd, onGetVote, null, "node", nodeId ); 		}				// The return function from Drupal.		private function onGetVote( result:Object )		{			// Set the fill width of our voting movie clips to the value.			if( userMode ) {				uservote.fill.width = result.value;			}			else {				vote.fill.width = result.value;			}		}				// Called when the user makes a vote.		private function onVote( event:MouseEvent ) 		{			// Check to make sure we know what node we are.			if( nodeId )			{				// Get the value of the vote that was clicked.				var voteValue:String = event.target.name.substr(1);				drupal.serviceCall( "vote.setVote", onGetVote, null, "node", nodeId, voteValue );			} 		}						// Called when the user hovers over a vote.		private function onVoteOver( event:MouseEvent ) 		{			voting.fill.width = event.target.name.substr(1);		}								// Called when the user moves his mouse out.		private function onOut( event:MouseEvent ) 		{			voting.fill.width = 0;			}				// Declare all of our child movie clips		public var votes:MovieClip;		public var vote:MovieClip;		public var uservote:MovieClip;		public var voting:MovieClip;						// Keep track of what mode we are in.		private var userMode:Boolean;						// Store the node Id.		private var nodeId:Number = 0;						// Store the drupal connection.		private var drupal:DrupalService;	}}