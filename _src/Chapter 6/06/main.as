// Declare our variablesvar baseURL:String = "http://localhost/drupalbook";var gateway:String = baseURL + "/services/amfphp"var sessionId:String = "";var nodeId:Number = root.loaderInfo.parameters.node;//root.loaderInfo.parameters.node;// Declare our Drupal connectionvar drupal:NetConnection = new NetConnection();drupal.objectEncoding = ObjectEncoding.AMF3;// Connect to the Drupal gatewaydrupal.connect( gateway );// Set up our responder with the callbacks.var responder:Responder = new Responder( onConnect, onError);// Connect to Drupaldrupal.call("system.connect", responder);// Loads a Drupal node.function loadNode( nid:Number ){	// Set up our responder with the callbacks.	var nodeResponse:Responder = new Responder( onNodeLoad, onError);	// Call Drupal to get the node.	drupal.call( "node.get", nodeResponse, sessionId, nid );}// Called when Drupal returns with our node.function onNodeLoad( node:Object ){	// Print out the node title.	title.text = node.title;			// Declare our base URL.	var fileURL:String = baseURL;			// Add our file’s relative path.	fileURL += "/";		// Declare a generic media player.	var player = null;		// If this node has audio.	if( node.audio ) {				// Declare our player as an AudioPlayer.		fileURL += node.audio.file.filepath;		player = new AudioPlayer();	}	else if( node.field_video ) {				// Declare our player as a VideoPlayer.		fileURL += node.field_video[0]["filepath"];		player = new VideoPlayer();			}	// Add the player to the stage.	addChild( player );	// Play our audio file	player.load( fileURL );}// Called when Drupal returns with a successful connection.function onConnect( result:Object ){	// Set our sessionId variable.	sessionId = result.sessid;			trace("We are connected!!!");	trace("Session Id: " + sessionId);			// Load our node.	loadNode( nodeId );	}// Called when an error occurs connecting to Drupal.function onError( error:Object ){	for each (var item in error) {		trace(item);   }}