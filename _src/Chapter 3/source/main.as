// Declare our variablesvar baseURL:String = "http://localhost/drupalbook";var gateway:String = baseURL + "/services/amfphp"var sessionId:String = "";var nodeId:Number = root.loaderInfo.parameters.node;// Declare our Drupal connectionvar drupal:NetConnection = new NetConnection();drupal.objectEncoding = ObjectEncoding.AMF3;// Connect to the Drupal gatewaydrupal.connect( gateway );// Set up our responder with the callbacks.var responder:Responder = new Responder( onConnect, onError);// Connect to Drupaldrupal.call("system.connect", responder);// Loads a Drupal node.function loadNode( nid:Number ){	// Set up our responder with the callbacks.	var nodeResponse:Responder = new Responder( onNodeLoad, onError);	// Call Drupal to get the node.	drupal.call( "node.get", nodeResponse, sessionId, nid );}// Called when Drupal returns with our node.function onNodeLoad( node:Object ){	// Print out the node title.	title.text = node.title;		// Print out the description.	description.htmlText = node.body;		// Show the ingredients and instructions.	ingredients.text = node.field_ingredients[0]["value"];	instructions.text = node.field_instructions[0]["value"];		// Update the scroll bars.	ingredientScroll.update();	instructionScroll.update();}// Called when Drupal returns with a successful connection.function onConnect( result:Object ){	// Set our sessionId variable.	sessionId = result.sessid;			trace("We are connected!!!");	trace("Session Id: " + sessionId);			// Load our node.	loadNode( nodeId );	}// Called when an error occurs connecting to Drupal.function onError( error:Object ){	for each (var item in error) {		trace(item);   }}